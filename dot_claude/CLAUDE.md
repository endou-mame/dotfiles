# グローバル開発ガイドライン

## 言語設定

- 会話: 日本語で応答する
- コミットメッセージ: 日本語で記述し、「なぜ」変更したかを重視する

## ファイル命名規則

- ファイル名・ディレクトリ名は英語（ASCII 文字）のみを使用する
- 日本語や全角文字をファイル名に含めない

## 記法ルール

- 太字 (`**text**`) を使わず、読みやすい文章を書く
- コード内にコメントを書かない。設定ファイルの説明コメントも不要

## ファイル編集・作成の許可

Edit / Write ツールを使用する前に、必ずユーザーの明示的な許可を得ること。「〜しましょう」「〜に置け」などの発言は場所の指定であり、編集の許可ではない。「編集していい」「書いて」「作成して」など、明確な許可を確認してから実行する。

## コミット・プッシュ

指示された作業が完了したら、ユーザーに確認を求める。確認が OK であれば、コミットまで行う。git push は必ずユーザーの承認後に実行する。

## Subagent 活用ポリシー

コンテキスト節約のため、Subagent を積極活用する。メインエージェントはオーケストレーターとして振る舞い、実作業は Subagent に委譲する。

### 基本ルール

- 2 つ以上の独立したタスクが発生したら、即座に Task ツールで Subagent に委譲する
- 独立したタスクは必ず並列実行する（単一メッセージで複数の Task ツール呼び出し）
- Subagent には `model: opus` を指定する
- バックグラウンド実行（`run_in_background: true`）を活用し、複数 Subagent を同時稼働させる
- Subagent の結果は `TaskOutput` で回収して統合報告する

### Subagent に委譲すべきタスク

| カテゴリ     | タスク例                                         |
| ------------ | ------------------------------------------------ |
| コード探索   | ファイル検索、パターン検索、アーキテクチャ調査   |
| 実装         | 機能追加、バグ修正、リファクタリング             |
| テスト       | テスト実行、テスト修正、カバレッジ確認           |
| ドキュメント | README 更新、API ドキュメント作成                |
| デバッグ     | エラー調査、ログ分析、原因特定                   |
| リサーチ     | 技術調査、ライブラリ比較、ベストプラクティス調査 |
| Web 検索     | 最新情報収集、ドキュメント確認、エラー解決策検索 |

### 並列実行の例

```
ユーザー: 「テストを修正して、ドキュメントも更新して」

→ 並列で 2 つの Task を起動:
  - Task 1: テスト修正（model: opus, run_in_background: true）
  - Task 2: ドキュメント更新（model: opus, run_in_background: true）
→ TaskOutput で結果を回収
→ 統合して報告
```

```
ユーザー: 「React 19 の新機能と、現在のコードベースでの使用箇所を調べて」

→ 並列で 2 つの Task を起動:
  - Task 1: Web 検索で React 19 の新機能を調査
  - Task 2: コードベースで React 関連の実装を探索
→ 両方の結果を統合して報告
```

### メインエージェントの役割

- タスクの分解と Subagent への割り振り
- 結果の統合と最終報告
- ユーザーとのコミュニケーション
- 全体の進捗管理

細かいファイル操作やコード変更は自分で行わず、Subagent に任せる。

## ハルシネーション防止

- 機能について言及する前にコードを確認する。不確かな場合は「確認します」と言ってから調べる。
- URL を勝手に作り出さない。テストにはユーザーが提供した URL のみ使用する。
- 外部 URL をユーザーに提案する前に、必ず WebFetch でアクセスして存在と動作を確認する。検索結果に出てきただけでは不十分。401/403/404 エラーが返った URL は提案しない。
- API コールは必要最小限に。1 回のテストで確認できたら追加テストは不要。ユーザーは API 料金を払っている。

## Web 検索時の注意

現在は 2025 年。Web 検索時は必ず「2025」を含めて検索すること。2024 年以前の情報は古い可能性が高い。

## CLI コマンドの構文確認

不明な CLI コマンドは推測で実行せず、まずヘルプを確認する。

```bash
op item create --help
op item template list
op item template get "API Credential"
```
